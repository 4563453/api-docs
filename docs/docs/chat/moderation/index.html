<!DOCTYPE html>
<html lang="en" dir=>

<head>
  <meta name="generator" content="Hugo 0.79.1" />
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Chat Moderation#Using the Glimesh API we can use mod features such as timeouts and bans. These are critical for chatbots and other services. Before starting this tutorial you should have a working connection to the API and understand basic GraphQL.
 New to GraphQL? This tutorial explains the basics. https://graphql.org/learn/schema/
  If you are looking for live updates related to moderation you can apply the queries in this tutorial to our Live Updates tutorial here.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="" />
<meta property="og:description" content="Chat Moderation#Using the Glimesh API we can use mod features such as timeouts and bans. These are critical for chatbots and other services. Before starting this tutorial you should have a working connection to the API and understand basic GraphQL.
 New to GraphQL? This tutorial explains the basics. https://graphql.org/learn/schema/
  If you are looking for live updates related to moderation you can apply the queries in this tutorial to our Live Updates tutorial here." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://glimesh.github.io/api-docs/docs/chat/moderation/" />
<meta property="article:modified_time" content="2021-02-21T19:47:40-06:00" />
<title>Moderation | API-Docs</title>
<link rel="manifest" href="/api-docs/manifest.json">
<link rel="icon" href="/api-docs/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/api-docs/book.min.4b53eeb588f75ee8d167188c6112d5918363d01776e01745616156129efa4644.css" integrity="sha256-S1PutYj3XujRZxiMYRLVkYNj0Bd24BdFYWFWEp76RkQ=">
<script defer src="/api-docs/en.search.min.548f21aa2b8a83316190ca378f35fea27b70cee06f1ed77d3652fdaf36b9d5d7.js" integrity="sha256-VI8hqiuKgzFhkMo3jzX&#43;ontwzuBvHtd9NlL9rza51dc="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  <script src="https://kit.fontawesome.com/a076d05399.js"></script>

<script src="https://cdn.jsdelivr.net/npm/react@16/umd/react.production.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/react-dom@16/umd/react-dom.production.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/graphql-voyager/dist/voyager.css"/>
<script src="https://cdn.jsdelivr.net/npm/graphql-voyager/dist/voyager.min.js"></script>
</head>

<body dir=>
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/api-docs"><img src="/api-docs/glimesh.png" alt="Logo" /><span>API-Docs</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-bf7b3283e3790c00c8caaa140299052b" class="toggle"  />
    <label for="section-bf7b3283e3790c00c8caaa140299052b" class="flex justify-between">
      <a  class="">Api</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ed8e1e4d4f4c1e3672708d733258fa51" class="toggle"  />
    <label for="section-ed8e1e4d4f4c1e3672708d733258fa51" class="flex justify-between">
      <a  class="">Live Updates</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/live-updates/channels/" class="">Channels</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/live-updates/followers/" class="">Followers</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ed972e555096d8550e03791bdee2d785" class="toggle"  />
    <label for="section-ed972e555096d8550e03791bdee2d785" class="flex justify-between">
      <a  class="">Query Api</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/query-api/basic-query/" class="">Basic Query</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/query-api/nodejs/node-query/" class="">Node Query</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/voyager/" class="">Voyager</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-46070fb9a15f8281e5989a88905887d2" class="toggle"  />
    <label for="section-46070fb9a15f8281e5989a88905887d2" class="flex justify-between">
      <a  class="">Authentication</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-cd9d01c15ace32e6fd3da5d1201bcd57" class="toggle"  />
    <label for="section-cd9d01c15ace32e6fd3da5d1201bcd57" class="flex justify-between">
      <a  class="">Access Token</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/authentication/accesstoken/clientcredentials/" class="">Client Credentials</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/authentication/accesstoken/accesstoken/" class="">Access Token</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/authentication/accesstoken/nodejs/node-access-token/" class="">Node Access Token</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1a1dc1f670e3426ff413fcd1f7e7ec36" class="toggle"  />
    <label for="section-1a1dc1f670e3426ff413fcd1f7e7ec36" class="flex justify-between">
      <a  class="">Refresh Token</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/authentication/refreshtoken/refreshtoken/" class="">Refresh Token</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-05db2d31fc2e5a419ce9fd1c0e938e4e" class="toggle" checked />
    <label for="section-05db2d31fc2e5a419ce9fd1c0e938e4e" class="flex justify-between">
      <a  class="">Chat</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9c7ac9316f3056fdea1a344042fc8cb8" class="toggle"  />
    <label for="section-9c7ac9316f3056fdea1a344042fc8cb8" class="flex justify-between">
      <a  class="">Projects</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/projects/sitewidesubscription/" class="">Site Wide Subscription</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/chat-tokens/" class="">Chat Tokens</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/moderation/" class=" active">Moderation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/mutations/" class="">Mutations</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/websockets/" class="">Websockets</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-084ba1dbb512652712ad881ff8045610" class="toggle"  />
    <label for="section-084ba1dbb512652712ad881ff8045610" class="flex justify-between">
      <a  class="">Reference</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/channel/" class="">Channel</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/chat/" class="">Chat</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/chatparts/" class="">Chat Parts</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/mod/" class="">Mod</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/scopes/" class="">Scopes</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/contributing/" class="">Contributing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/dev-app/" class="">Dev App</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c51f25d1917de848e9ad26913759c6eb" class="toggle"  />
    <label for="section-c51f25d1917de848e9ad26913759c6eb" class="flex justify-between">
      <a  class="">Developer Resources</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/developerresources/libraries/" class="">Libraries</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/api-docs/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Moderation</strong>

  <label for="toc-control">
    
    <img src="/api-docs/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  <nav id="TableOfContents">
  <ul>
    <li><a href="#understanding-mod-actions">Understanding Mod Actions</a></li>
    <li><a href="#connection">Connection</a>
      <ul>
        <li><a href="#timeouts">Timeouts</a></li>
        <li><a href="#bans">Bans</a></li>
      </ul>
    </li>
    <li><a href="#moderation-log">Moderation Log</a></li>
  </ul>
</nav>


  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="chat-moderation">
  Chat Moderation
  <a class="anchor" href="#chat-moderation">#</a>
</h1>
<p>Using the Glimesh API we can use mod features such as timeouts and bans. These are critical for chatbots and other services. Before starting this tutorial you should have a working connection to the API and understand basic GraphQL.</p>
<blockquote>
<p>New to GraphQL? This tutorial explains the basics. <a href="https://graphql.org/learn/schema/">https://graphql.org/learn/schema/</a></p>
</blockquote>
<blockquote>
<p>If you are looking for live updates related to moderation you can apply the queries in this tutorial to our Live Updates tutorial <a href="/api-docs/docs/api/live-updates/channels">here</a>.</p>
</blockquote>
<h2 id="understanding-mod-actions">
  Understanding Mod Actions
  <a class="anchor" href="#understanding-mod-actions">#</a>
</h2>
<p>Glimesh has various methods to help streamers moderate their chat. All of the below methods are useable through the API.</p>
<table>
<thead>
<tr>
<th>Action</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td>banUser</td>
<td>Bans the user from the channel.</td>
</tr>
<tr>
<td>unbanUser</td>
<td>Removes the ban on a user.</td>
</tr>
<tr>
<td>longTimeoutUser</td>
<td>Prevents a user from typing for 15 minutes.</td>
</tr>
<tr>
<td>shortTimeoutUser</td>
<td>Prevents a user from typing for 5 minutes.</td>
</tr>
</tbody>
</table>
<p>To use any of these methods you must have the proper rank in the chat. You need to be a streamer or a moderator in their chat. You also need the user ID of the user who will receive the action and the channel ID of the channel in which the action will take place.  You can get a channel ID with the below query.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-GraphQL" data-lang="GraphQL">
<span style="color:#66d9ef">query</span> {
  <span style="color:#a6e22e">channel</span>(username: <span style="color:#e6db74">&#34;NAMEHERE&#34;</span>) {
    <span style="color:#a6e22e">id</span>
  }
}

</code></pre></div><p>A user ID can be attained from various queries. Since you are likely in a chat you can pull the ID from the chatMessage event. Your subscription to a chat (to listen for chat messages) would look something like this.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-GraphQL" data-lang="GraphQL">
<span style="color:#66d9ef">subscription</span> {
  <span style="color:#a6e22e">chatMessage</span>(channelId:<span style="color:#a6e22e">6</span>) {
    message,
    user {
      id
    }
  }
}

</code></pre></div><p>The message would be the chat message and the ID in the user object would be the ID of the user who sent the message.</p>
<blockquote>
<p>There is also an ID property in the chatMessage. This is the ID of the message, <strong>not</strong> a user or channel ID. Don&rsquo;t get them confused!</p>
</blockquote>
<h2 id="connection">
  Connection
  <a class="anchor" href="#connection">#</a>
</h2>
<p>Now that we have a method to get the user and channel IDs we can start <del>banning everyone</del> moderating!</p>
<blockquote>
<p>Memes aside, you always need to use the API responsibly. Bots, AI, and message parsing can fail and you never want to wrongly ban a user. Always ensure that any automated services log all their actions. You may need to go back and unban someone if a mistake is made.</p>
</blockquote>
<p>For testing purposes you should use your own channel and a bot account. You <em>can</em> ban yourself but it&rsquo;s easier to use a different account. Glimesh uses mutations to moderate users. Mutations can be sent in http or websocket form. If you are in chat it is best to use the websocket since a connection would already be open.</p>
<h3 id="timeouts">
  Timeouts
  <a class="anchor" href="#timeouts">#</a>
</h3>
<p>Send this to the API to timeout a user for 5 minutes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Graphql" data-lang="Graphql"><span style="color:#66d9ef">mutation</span> {
  <span style="color:#a6e22e">shortTimeoutUser</span>(channelId:<span style="color:#a6e22e">6</span>, userId:<span style="color:#a6e22e">201</span>) {
    action,
    moderator {displayname},
  }
}
</code></pre></div><blockquote>
<p>You need to replace 6 and 201 with the proper IDs.</p>
</blockquote>
<p>A long timeout is very similar. This will last for 15 minutes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql">
<span style="color:#66d9ef">mutation</span> {
  <span style="color:#a6e22e">longTimeoutUser</span>(channelId:<span style="color:#a6e22e">6</span>, userId:<span style="color:#a6e22e">201</span>) {
    action,
    moderator {displayname},
  }
}

</code></pre></div><h3 id="bans">
  Bans
  <a class="anchor" href="#bans">#</a>
</h3>
<p>Banning users works the same way. Simply replace the timeout mutation with the ban mutation.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql">
<span style="color:#66d9ef">mutation</span> {
  <span style="color:#a6e22e">banUser</span>(channelId:<span style="color:#a6e22e">6</span>, userId:<span style="color:#a6e22e">201</span>) {
    action,
    moderator {displayname}
  }
}

</code></pre></div><p>If you need to unban a user you can use this mutation.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql">
<span style="color:#66d9ef">mutation</span> {
  <span style="color:#a6e22e">unbanUser</span>(channelId:<span style="color:#a6e22e">6</span>, userId:<span style="color:#a6e22e">201</span>) {
    action,
    moderator {displayname}
  }
}

</code></pre></div><p>Attempting to unban a user that is not banned will return an internal server error. Attempting to use any moderator action on a user that does not exist will return &ldquo;not found&rdquo;. Using moderator actions in a channel that you do not have the authorization will result in an error. If you need more information about what properties you can receive from a moderator action check out the <a href="/api-docs/docs/reference/mod/">moderator reference</a>. It provides a list of all the properties you can request. <a href="https://glimesh.tv/api">Glimesh.tv/api</a> has a full list of all the API features.</p>
<h2 id="moderation-log">
  Moderation Log
  <a class="anchor" href="#moderation-log">#</a>
</h2>
<p>Glimesh stores a copy of all the moderation events that happen to a user.  This log can be viewed by the streamer <a href="https://glimesh.tv/users/settings/channel/mods">here</a>.
<img src="https://i.imgur.com/zy3yhhy.png" alt="Mod Log" /></p>
<p>We can also access this log via the API. Unlike the webpage, this log can be viewed by any user! Let&rsquo;s create a basic query.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql">
<span style="color:#66d9ef">query</span> {
  <span style="color:#a6e22e">channel</span>(id:<span style="color:#a6e22e">6</span>) {
    moderationLogs {
      action,
      moderator {username}
    }
  }
}

</code></pre></div><p>This will return an array of data showing the moderation log.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS">
{
  <span style="color:#e6db74">&#34;data&#34;</span><span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#34;channel&#34;</span><span style="color:#f92672">:</span> {
      <span style="color:#e6db74">&#34;moderationLogs&#34;</span><span style="color:#f92672">:</span> [
        {
          <span style="color:#e6db74">&#34;action&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;short_timeout&#34;</span>,
          <span style="color:#e6db74">&#34;moderator&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Mytho&#34;</span>
          }
        },
        {
          <span style="color:#e6db74">&#34;action&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;short_timeout&#34;</span>,
          <span style="color:#e6db74">&#34;moderator&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Mytho&#34;</span>
          }
        },
        {
          <span style="color:#e6db74">&#34;action&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;long_timeout&#34;</span>,
          <span style="color:#e6db74">&#34;moderator&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Mytho&#34;</span>
          }
        },
        {
          <span style="color:#e6db74">&#34;action&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;long_timeout&#34;</span>,
          <span style="color:#e6db74">&#34;moderator&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Mytho&#34;</span>
          }
        },
        {
          <span style="color:#e6db74">&#34;action&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ban&#34;</span>,
          <span style="color:#e6db74">&#34;moderator&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Mytho&#34;</span>
          }
        },
        {
          <span style="color:#e6db74">&#34;action&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;unban&#34;</span>,
          <span style="color:#e6db74">&#34;moderator&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Mytho&#34;</span>
          }
        }
      ]
    }
  }
}

</code></pre></div><p>That is the basis for using moderation actions with the API. All of the above queries and mutations can be done through a websocket connection as well as a normal query.</p>
<p>If you have any questions talk to us in the #dev channel in our <a href="https://discord.gg/Glimesh">Discord</a>.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">



  <div><a class="flex align-center" href="https://github.com/Glimesh/api-docs/commit/9a5f733b3c2d4a425de666827f45565eb33b4370" title='Last modified by MythoAway7 | February 21, 2021' target="_blank" rel="noopener">
      <img src="/api-docs/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>February 21, 2021</span>
    </a>
  </div>



</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#understanding-mod-actions">Understanding Mod Actions</a></li>
    <li><a href="#connection">Connection</a>
      <ul>
        <li><a href="#timeouts">Timeouts</a></li>
        <li><a href="#bans">Bans</a></li>
      </ul>
    </li>
    <li><a href="#moderation-log">Moderation Log</a></li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












