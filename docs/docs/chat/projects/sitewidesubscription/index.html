<!DOCTYPE html>
<html lang="en" dir=>

<head>
  <meta name="generator" content="Hugo 0.79.1" />
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Site Wide Chat Messages#The Glimesh API allows you to subscribe to any channel to listen for chat messages. There is no limit to the amount of channels that you can listen to. In this project we will listen for every chat message from every user across the entire site. Before starting you should fully understand the WebSocket Tutorial.
First we need to open a websocket connection to Glimesh.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="" />
<meta property="og:description" content="Site Wide Chat Messages#The Glimesh API allows you to subscribe to any channel to listen for chat messages. There is no limit to the amount of channels that you can listen to. In this project we will listen for every chat message from every user across the entire site. Before starting you should fully understand the WebSocket Tutorial.
First we need to open a websocket connection to Glimesh." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://glimesh.github.io/api-docs/docs/chat/projects/sitewidesubscription/" />
<meta property="article:modified_time" content="2021-01-08T09:33:25-06:00" />
<title>Site Wide Subscription | API-Docs</title>
<link rel="manifest" href="/api-docs/manifest.json">
<link rel="icon" href="/api-docs/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/api-docs/book.min.4b53eeb588f75ee8d167188c6112d5918363d01776e01745616156129efa4644.css" integrity="sha256-S1PutYj3XujRZxiMYRLVkYNj0Bd24BdFYWFWEp76RkQ=">
<script defer src="/api-docs/en.search.min.0dc437db238675dde5f4c6c95366bd5c6d016085cf408d38b3db510a480d3d91.js" integrity="sha256-DcQ32yOGdd3l9MbJU2a9XG0BYIXPQI04s9tRCkgNPZE="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  <script src="https://kit.fontawesome.com/a076d05399.js"></script>

<script src="https://cdn.jsdelivr.net/npm/react@16/umd/react.production.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/react-dom@16/umd/react-dom.production.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/graphql-voyager/dist/voyager.css"/>
<script src="https://cdn.jsdelivr.net/npm/graphql-voyager/dist/voyager.min.js"></script>
</head>

<body dir=>
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/api-docs"><img src="/api-docs/glimesh.png" alt="Logo" /><span>API-Docs</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-bf7b3283e3790c00c8caaa140299052b" class="toggle"  />
    <label for="section-bf7b3283e3790c00c8caaa140299052b" class="flex justify-between">
      <a  class="">Api</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ed8e1e4d4f4c1e3672708d733258fa51" class="toggle"  />
    <label for="section-ed8e1e4d4f4c1e3672708d733258fa51" class="flex justify-between">
      <a  class="">Live Updates</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/live-updates/channels/" class="">Channels</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ed972e555096d8550e03791bdee2d785" class="toggle"  />
    <label for="section-ed972e555096d8550e03791bdee2d785" class="flex justify-between">
      <a  class="">Query Api</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/query-api/basic-query/" class="">Basic Query</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/query-api/nodejs/node-query/" class="">Node Query</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/voyager/" class="">Voyager</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-46070fb9a15f8281e5989a88905887d2" class="toggle"  />
    <label for="section-46070fb9a15f8281e5989a88905887d2" class="flex justify-between">
      <a  class="">Authentication</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-cd9d01c15ace32e6fd3da5d1201bcd57" class="toggle"  />
    <label for="section-cd9d01c15ace32e6fd3da5d1201bcd57" class="flex justify-between">
      <a  class="">Access Token</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/authentication/accesstoken/accesstoken/" class="">Access Token</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/authentication/accesstoken/nodejs/node-access-token/" class="">Node Access Token</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1a1dc1f670e3426ff413fcd1f7e7ec36" class="toggle"  />
    <label for="section-1a1dc1f670e3426ff413fcd1f7e7ec36" class="flex justify-between">
      <a  class="">Refresh Token</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/authentication/refreshtoken/refreshtoken/" class="">Refresh Token</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-05db2d31fc2e5a419ce9fd1c0e938e4e" class="toggle" checked />
    <label for="section-05db2d31fc2e5a419ce9fd1c0e938e4e" class="flex justify-between">
      <a  class="">Chat</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9c7ac9316f3056fdea1a344042fc8cb8" class="toggle" checked />
    <label for="section-9c7ac9316f3056fdea1a344042fc8cb8" class="flex justify-between">
      <a  class="">Projects</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/projects/sitewidesubscription/" class=" active">Site Wide Subscription</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/chat-tokens/" class="">Chat Tokens</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/moderation/" class="">Moderation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/mutations/" class="">Mutations</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/websockets/" class="">Websockets</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-084ba1dbb512652712ad881ff8045610" class="toggle"  />
    <label for="section-084ba1dbb512652712ad881ff8045610" class="flex justify-between">
      <a  class="">Reference</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/channel/" class="">Channel</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/chat/" class="">Chat</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/chatparts/" class="">Chat Parts</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/mod/" class="">Mod</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/scopes/" class="">Scopes</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/contributing/" class="">Contributing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/dev-app/" class="">Dev App</a>
  

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/api-docs/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Site Wide Subscription</strong>

  <label for="toc-control">
    
    <img src="/api-docs/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  <nav id="TableOfContents"></nav>


  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="site-wide-chat-messages">
  Site Wide Chat Messages
  <a class="anchor" href="#site-wide-chat-messages">#</a>
</h1>
<p>The Glimesh API allows you to subscribe to any channel to listen for chat messages. There is no limit to the amount of channels that you can listen to. In this project we will listen for every chat message from every user across the entire site. Before starting you should fully understand the <a href="/api-docs/docs/chat/websockets/">WebSocket Tutorial</a>.</p>
<p>First we need to open a websocket connection to Glimesh. Use the process from the websocket tutorial linked above to get the connection open. Instead of subscribing to a specific channel you want to subscribe to the <code>chatMessage</code> event. You can do so with this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JSON" data-lang="JSON">[<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;__absinthe__:control&#34;</span>,<span style="color:#e6db74">&#34;doc&#34;</span>,{<span style="color:#f92672">&#34;query&#34;</span>:<span style="color:#e6db74">&#34;subscription{ chatMessage { user { username avatar } message } }&#34;</span>}]
</code></pre></div><p>Normally the event requires a channel ID as a parameter. Since we don&rsquo;t specify which channel to listen to it connects to every channel on the site. All you have to do is log the messages as they come in!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JSON" data-lang="JSON">[<span style="color:#66d9ef">null</span>,<span style="color:#66d9ef">null</span>,<span style="color:#e6db74">&#34;__absinthe__:doc:-576460752298178591:33B2AA3BF7B8F0E158810EF0E0166F5E05840BE57444C92365C921943942A47D&#34;</span>,<span style="color:#e6db74">&#34;subscription:data&#34;</span>,{<span style="color:#f92672">&#34;result&#34;</span>:{<span style="color:#f92672">&#34;data&#34;</span>:{<span style="color:#f92672">&#34;chatMessage&#34;</span>:{<span style="color:#f92672">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;hello world!&#34;</span>,<span style="color:#f92672">&#34;user&#34;</span>:{<span style="color:#f92672">&#34;avatar&#34;</span>:<span style="color:#e6db74">&#34;/uploads/avatars/Mytho.png?v=63762672056&#34;</span>,<span style="color:#f92672">&#34;username&#34;</span>:<span style="color:#e6db74">&#34;Mytho&#34;</span>}}}},<span style="color:#f92672">&#34;subscriptionId&#34;</span>:<span style="color:#e6db74">&#34;__absinthe__:doc:-576460752298178591:33B2AA3BF7B8F0E158810EF0E0166F5E05840BE57444C92365C921943942A47D&#34;</span>}]
</code></pre></div><p>In the example above we requested the message as well as the username and avatar of the chatter. This query shows all of the possible data we can get from a chat message.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql">
<span style="color:#66d9ef">subscription</span> {
  <span style="color:#a6e22e">chatMessage</span> {
    id,
    insertedAt,
    message,
    updatedAt,
    channel { 
      <span style="color:#75715e"># Channel data</span>
    },
    user { 
      <span style="color:#75715e"># User data</span>
    }
  }
}

</code></pre></div><p>This is all of the info required to listen to every chatroom. If you have any questions talk to us on our <a href="https://discord.gg/Glimesh">Discord</a>.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">



  <div><a class="flex align-center" href="https://github.com/Glimesh/api-docs/commit/2383c0f88173c34a551e5ba7e456bdc8c25e367c" title='Last modified by aMytho | January 8, 2021' target="_blank" rel="noopener">
      <img src="/api-docs/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>January 8, 2021</span>
    </a>
  </div>



</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents"></nav>

 
    </aside>
    
  </main>

  
</body>

</html>












